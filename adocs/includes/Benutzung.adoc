== Benutzung

WARNING: Auf meiner Tastatur ist momentan das "ICKS" kaputt! Wenn also ein "ICKS" benötigt wird, muss ich leider "cks" eingeben. Ich hoffe, das macht nicks ;-) 

=== Begriffe

//[horizontal]

Periode (Zeitraum)::
    Es besteht eine Arbeitsdienstpflicht für das gesamte Jahr, es muss aber pro Halbjahr eine bestimmte Anzahl von Stunden geleistet werden. Die Abrechnung erfolgt daher jeweils für ein Halbjahr. Dieser Abrechnungszeitraum wird im Programm #Periode# oder #Zeitraum# genannt.

Aktive Periode::
    Die aktive Periode ist das zeitlich erste Halbjahr, das noch nicht abgerechnet worden ist.
    
Abgeschlossene Periode::
    Eine Periode ist dann abgeschlossen, wenn alle Arbeitsdienstleistungen eingetragen sind, der *BAUAUSSCHUSS* das Abschließen ecksplizit durchgeführt hat und die Daten auf den Server hochgeladen worden sind.
    Daten einer  abgeschlossenen Periode können nicht mehr verändert werden!


=== Bestandteile der Bedienung

==== Hauptfenster

.Hauptfenster
image::App-0.png[align="center"]

Nach dem Start der Applikation erscheint das Hauptfenster, das eine Vielzahl an Informationen enthält.

===== Titelleiste

Die *Titelleiste* gibt die aktuelle Version der benutzten Software an (hier: #_1.3.2-SNAPSHOT_# ), den Namen des Server-Accounts (hier: #_kvk_#) sowie das Hauptverzeichnis, mit dem gearbeitet wird (hier: #_Arbeitsdienstabrechnungen-Test_#)

.Titelleiste
image::App-Titelleiste.png[align="center"]


===== Selektionsbereich

Im *Selektionsbereich* werden die betrachtete Periode und das Mitglied ausgewählt. Die aktive Periode ist immer mit einem #*# am Ende markiert.

.Selektionsbereich
image::App-Selektion.png[align="center"]

Das Selektieren eines Mitgliedes erfolgt über die Anwahl der Auswahlbocks 

Ist die Auswahlbocks selektiert, kann einfach begonnen werden, mit der Tastatur einen Nachnamen einzugeben. Die Bocks springt dann sofort zum ersten passenden Mitglied.

Für das selektierte Mitglied wird der Name angegeben und dahinter in Klammern die interne Mitgliedsnummer. Werden die Zahlungen für das betreffende Mitglied vom Konto eines anderen Mitgliedes abgebucht (z.B. Vater, Ehefrau, ...), erscheint diese Referenz ebenfalls in der Auswahlzeile.

===== Informationen zum Mitglied

Im *Informationsbereich* sind einige Angaben zum selektierten Mitglied aufgeführt, die für die Berechnung der Arbeitsdienstpflichten von Bedeutung sind.

.Informationen zum Mitglied
image::App-0-Info.png[align="center"]

Die Liste der Arbeitsdienstbefreiungen (#AD-Befreiungen#) gibt an, von wann bis wann das betreffende Mitglied aus welchem Grund von der Arbeitsdienstpflicht befreit ist. Mögliche Gründe für eine Befreiung sind:

 Aus den Mitgliedsdaten ermittelte Gründe:

TOO_YOUNG::
    Arbeitsdienstpflicht besteht erst mit Vollendung des 16. Lebensjahres.

DUTY_NOT_YET_EFFECTIVE::
    Arbeitsdienstpflicht besteht erst nach einem halben Jahr Vereinsmitgliedschaft.
    
TOO_OLD::
    Arbeitsdienstpflicht besteht nur bis zur Vollendung des 60. Lebensjahres.

NO_LONGER_MEMBER::
    Die Person ist zum Zeitpunkt der Abrechnung kein Mitglied im Verein mehr.
    
 Explizit anzugebende Gründe:
 
SUSTAINING::
    Mitglied hat den Status "Fördermitglied"
HONORY::
    Mitglied hat den Status "Ehrenmitglied"

MANAGEMENT::
    Mitglied bekleidet einen Vorstandsposten

REMOTENESS::
    Mitglied wohnt weiter als 50 km vom Verein entfernt.
    
INDIVIDUALREASON::
    Mitglied ist aus besonderem Grund vom Arbeitsdienst befreit.


===== Abrechnungsbereich

Im *Abrechnungsbereich* sind die durch das selektierte Mitglied innerhalb der selektierten Periode geleisteten Arbeitsdienststunden aufgeführt. Darunter befindet sich die Abrechnung für den ausgewählten Zeitraum.

.Abrechnungsbereich
image::App-0-Abrechnungsbereich.png[align="center"]

Wird das Konto des selektierten Mitglieds von anderen Mitgliedern (z.B. Familienangehörigen) referenziert, werden diese in der Tabelle der Abrechnungen ebenfalls aufgeführt.

Die einzelnen Spalten in der Abrechnungstabelle haben folgende Bedeutung:

Guthaben::
    Summe der Stunden, die das Mitglied aus der Vergangenheit als Guthaben mit in den Abrechnungszeitraum einbringt.

Gutschrift::
    In diesem Abrechnungszeitraum gutgeschriebene Stunden (aufgrund früherer Fehlbuchungen)

Gearbeitet::
    Summe der Stunden, die das Mitglied innerhalb des Abrechnungszeitraums Arbeitsdienst geleistet hat.

Pflicht::
    Summe der Stunden, die das Mitglied innerhalb des Abrechnungszeitraums Arbeitsdienst leisten muss.

Guthaben II::
    Summe aus den Spalten #Guthaben#, #Gutschrift# und #Gearbeitet# des betreffenden Mitglieds.

Zu zahlen::
    Anzahl der Stunden, um die die Pflichtstunden für diesen Zeitraum den Wert der Spalte #Guthaben II# des jeweiligen Mitglieds übersteigen.

Guthaben III::
    Die Summe der Werte in der Spalte #Guthaben II# stellt das _Familienguthaben_ dar. Die Summe der Werte in der Spalte #Zu zahlen# stellt die _Familienschuld_ dar. In der Spalte #Guthaben III# wird das Familienguthaben gegen die Familienschuld aufgerechnet. Dabei werden die Guthaben der Familienmitglieder gleichmäßig reduziert.

In der letzten Zeile wird im Feld #Zu zahlende Stunden# angegeben, um wieviele Stunden die Familienschuld das Familienguthaben übersteigt.

===== Aktionsknöpfe

Bei den Aktionsknöpfen zeigt sich ein Unterschied in der Bedienung je nachdem, ob der *MITGLIEDERWART* oder der *BAUAUSSCHUSS* das Programm gestartet hat.

.Aktionsknöpfe
image::App-0-Aktionen.png[align="center"]

====== Mitgliederwart

In der Rolle *MITGLIEDERWART* hat man quasi nur lesenden Zugriff auf die Daten.
Über den Knopf kbd:[Arbeitsdienste] kann sich der Mitgliederwart einen Einblick in die vorliegenden Daten verschaffen (siehe <<Verwaltung der Arbeitsdienste>>), er kann aber keine Daten eingeben. Der Knopf kbd:[Zeitraum abschließen] ist in dieser Rolle nicht bedienbar.

Die einzig originäre Aufgabe des Mitgliederwartes ist es, eine 
aktualisierte Datei aus dem Mitgliederverwaltungsprogramm auf den 
Server zu laden. Dazu dient der Knopf kbd:[Daten hochladen...]. 
Der zugehörige Ablauf ist weiter unten beschrieben.

====== Bauausschuss

Der *BAUAUSSCHUSS* führt die Arbeitsdiensttermine im Verein durch und führt Buch über die dort geleisteten Stunden. Diese Aufgabe zu erleichtern, ist die Hauptaufgabe des Programmes +ADHelper+. Die einzelnen Bedienschritte sind im folgenden Abschnitt genauer beschrieben.

=== Hochladen neuer Basisdaten
Die einzig originäre Aufgabe des Mitgliederwartes ist es, eine 
aktualisierte Datei aus dem Mitgliederverwaltungsprogramm auf den 
Server zu laden. Dazu dient der Knopf kbd:[Daten hochladen...]. 

Er öffnet einen Auswahldialog, mit dem die neu aus dem Vereinsverwaltungsprogramm exportierte Datei im Dateisystem erbrowst wird.
Diese wird daraufhin zuerst auf ihre Konsistenz hin überprüft. 
Erfüllen die Daten nicht die an sie gestellten Anforderungen, wird der Prozess abgebrochen und keine Daten hochgeladen.

Nach der Konsistenzprüfing wird ein Vergleich zu den aktuell gültigen Daten durchgeführt. Das Ergebnis wird in einem Dialog angezeigt:

.Darstellung der Modifikationen der Daten
image::DatenDiffPanel.png[align="center"]

[NOTE]
====
Erläuterung der Bestandteile:

<1> Pfad der Datei mit den aktuellen Daten
<2> Pfad der Datei mit den neuen Daten
<3> Zeile in der aktuellen Datei, die in der neuen Datei modifiziert wurde
<4> Zeile in der neuen Datei mit modifizierten Daten
<5> Datenfelder, die modifiziert sind, werden gesondert hervorgehoben
<6> Zeile in der aktuellen Datei, die in der neuen Datei nicht mehr vorkommt
<7> Zeile in der neuen Datei, die in der aktuellen Datei noch nicht enthalten ist
====

Hier besteht noch einmal die Gelegenheit zu überprüfen, ob die Daten, die hochgeladen werden sollen, auch den erwarteten Inhalt haben.

Ist das nicht der Fall, kann über den Knopf 
kbd:[Daten verwerfen] das weitere Hochladen abgebrochen werden.

Wird der Knopf kbd:[Daten übernehmen] gedrückt, wird die Datei auf den Server hochgeladen. 
Alle dann folgenden Berechnungen werden ab dann basierend auf dem Stand der neuen Datei durchgeführt.

Das genaue Format der Datei der Basisdaten ist im link:developers-guide.html#Basisdaten[Enwicklerhandbuch] angegeben.

=== Verwaltung der Arbeitsdienste

Der Knopf kbd:[Arbeitsdienste ...] im <<Hauptfenster>> öffnet das Fenster zur Eingabe und Verwaltung der Arbeitsdienste.

.Fenster "Arbeitsdienste"
image::AppAD-0.png[align="center"]

Auch hier kann man wieder die zu betrachtende Periode auswählen und auch hier ist eine Änderung an Daten von abgeschlossenen Perioden nicht möglich. Die Daten bereits abgeschlossener Perioden können also nur zur Kontrolle angesehen werden. Die aktive Periode erkennt man an dem angehängten #*# im Auswahldialog.

Innerhalb des ausgewählten Zeitraumes gibt es in aller Regel mehr als einen Arbeitdiensttermin, aus denen man mit der zweiten Auswahlbocks auswählen kann. Es werden alle Mitglieder aufgelistet, die am ausgewählten Arbeitsdiensttermin Stunden geleistet haben.

Im Feld #Filter# kann man eine Zeichenkette eingeben, die die Liste der angezeigten Personen auf solche einschränkt, bei denen die Eingabe im Namen enthalten ist. Über kbd:[Reset Teckstfilter] kann man die Liste wieder vollständig anzeigen lassen.

==== Erfassung von Arbeitsdienststunden

Hat ein Arbeitsdiensttermin stattgefunden, müssen die dort geleisteten Arbeitsstunden in das Programm +ADHelper+ eingegeben werden. Dazu muss im geöffneten Arbeitsdienst-Fenster die aktive Periode ausgewählt sein.

NOTE: Es wird davon ausgegangen, dass der zu erfassende Arbeitsdienst in der gerade aktiven Periode stattgefunden hat. Eine vorauseilende Erfassung von Arbeitsdiensten für künftige Perioden ist nicht vorgesehen.

Ecksistiert für diesen Arbeitsdienst bereits ein Termin-Eintrag in der entsprechenden Auswahlbocks, ist dieser auszuwählen.
Im Normalfall ist mit dem Knopf kbd:[Neu] ein neuer Termin-Eintrag zu erzeugen.

WARNING: Im Datums-Auswahldialog für einen neuen Arbeitsdiensttermin ist besonders darauf zu achten, dass das korrekte Jahr ausgewählt wird!

Ist ein neuer Termin erzeugt worden, erscheint eine Liste aller aktuell erfassten Vereinsmitglieder. 

.Neuer Arbeitsdiensttermin
image::AppAD-0-neu.png[align="center"]

TODO: Bereits ausgetretene Mitglieder ausfiltern!

Es empfiehlt sich, in dieser Liste zuerst bei allen Personen, die den Arbeitsdienst besucht haben, einen Haken in der Spalte #Teilnahme# zu setzen.
Zum Auffinden der betreffenden Personen hilft das #Filter#-Feld, in das man den Anfang des Names der zu suchenden Person eintippt. Mit kbd:[Reset Teckstfilter] sieht man wieder alle Mitglieder.

Hat man alle Teilnehmer des Arbeitsdiensttermines auf diese Weise markiert, schränkt man die Ansicht durch Drücken der Knopfes kbd:[Nur Teilnehmer] ein und gewinnt so eine übersichtliche Liste.

.Ansicht "Nur Teilnehmer"
image::AppAD-0-nurTeilnehmer.png[align="center"]

In dieser reduzierten Liste kann für jeden Arbeiter die Anzahl der Stunden eingegen werden. Die Stunden können in Viertelstunden-Auflösung bis macksimal
10 Stunden eingegeben werden (mehr erlaubt das Arbeitszeitgesetz nicht!)

Ist das geschehen, muss die Eingabe durch Drücken des kbd:[Ok]-Knopfes abgeschickt werden. Die Arbeitsdienststunden können durchaus in mehreren Etappen eingegeben werden.

NOTE: Die neu erfassten Daten sind bis zu diesem Punkt nur auf dem lokalen Rechner gespeichert. Wenn das Programm beendet wird, wird festgestellt, dass sich die Daten gegenüber dem Bestand auf dem Server geändert haben. Es erscheint ein Dialog, ob die modifizierten Daten auf den Server übertragen werden sollen. Eine Bestätigung führt zum Hochladen und alle folgenden Programmläufe basieren auf den aktualisierten Daten. Bei Verwerfen des Hochladens wird der gesamte Ordner der geänderten Periode in den Unterordner *Obsolete* verschoben. Der dann folgende Programmlauf setzt wieder auf dem Datenbestand auf, wie er auf dem Server vorhanden war.
//--

==== Erfassung von Gutschriften

Wenn festgestellt worden ist, dass bei einem Mitglied in der Vergangenheit ein Fehler in der Berechnung bzw. Abbuchung vorlag, besteht die Möglichkeit, Gutschriften zu erfassen. Eine Gutschrift erfolgt in Stunden.

Die Erfassung von Gutschriften ist praktisch identisch mit der der Arbeitsstunden.

.Neue Gutschrift
image::AppGS-0-neu.png[align="center"]

Der wesentliche Unterschied ist, dass es immer nur eine Gutschrift pro Mitglied und Abrechnungszeitraum geben kann und der Termin immer fest auf den Beginn des Abrechnungszeitraum gelegt wird.

Für jede Gutschrift ist ein Kommentar anzulegen, der erläutert, warum die Gutschrift gewährt worden ist.

==== Abschluss eines Abrechnungszeitraumes

Ist sichergestellt, dass alle Arbeitsdiensttermine eines Abrechnungszeitraumes vollständig erfasst sind, kann der Zeitraum abgeschlossen werden. Dazu ist im <<Hauptfenster>> der Knopf kbd:[Zeitraum abschließen] zu drücken.

Mit dem "Abschließen"-Vorgang werden im Datenverzeichnis der aktiven Periode einige neue Dateien erzeugt (siehe auch <<Dateien eines Abrechnungszeitraumes>>). 
Die wichtigste ist die Datei #ZuZahlendeStunden.csv#, die dem Mitgliederwart die Information für die von den betreffenden Mitgliedern einzuziehenden Beträge gibt. Hier ist immer noch einmal eine Plausibilitätsüberprüfung vorzunehmen, bei der insbesondere die Datei #Details.tickst# wertvolle Informationen liefert.

NOTE: Auch hier gilt, dass die Information über den "Abschließen"-Vorgang vorerst nur lokal gespeichert ist und verworfen werden kann.

Beim nächste Start des Programmes nach dem Abschluss einer Periode wird eine neue Periode angelegt und als _aktiv_ markiert. 

NOTE: Bereits diese Aktion wird selbstverständlich als Veränderung der lokalen Daten erkannt, und bei Beenden des Programmes erscheint wiederum ein Dialog zur Bestätigung für das Hochladen der veränderten Daten.

=== PDF-Reports

Seit der Version 1.8.2 ist es möglich, anprechende PDF-Reports für jedes einzelne Mitglied auszugeben.
Diese Funktionalität ist über den Menu-Punkt kbd:[Aktionen/Erzeuge PDF-Reports] zugänglich:

image::PDFReports1.png[]

Man kann auswählen, ob man einen Bericht nur für das gerade selektierte Mitglied erstellen möchte oder für alle Mitglieder. 

Wird ein Bericht nur für das gerade selektierte Mitglied erstellt, erscheint die Ausgabe in einem separaten Fenster:

image::PDFReports2.png[]

Man kann in diesem Fenster entscheiden, ob man den Bericht auf Festplatte speichern oder ihn direkt auf einem Drucker ausgeben möchte.

Wird die Ausgabe für alle Mitglieder gewünscht, erscheint kein weiteres Fenster. Stattdessen wird eine PDF-Datei erstellt, die unter 

====
    Arbeitsdienstabrechnungen\Daten\PDFReports\
====

zu finden ist.

[WARNING]
====
Die Erzeugung von PDF-Reports für alle Mitglieder dauert ein Weilchen (bis zu einer Minute). Also nicht die Geduld verlieren!
====

[NOTE]
====
Die ausgegebenen PDF-Reports beziehen sich immer auf den gerade selektierten Abrechnungszeitraum.
====

=== Log-Ausgaben

Das Programm erzeugt während des Laufes einige Log-Ausgaben. Diese gehen einerseits in eine Datei und können andererseits auch in einem Fenster sichtbar gemacht werden. Das Fenster ist bei Programmstart aktiviert und kann gefahrlos geschlossen werden. Es kann jederzeit über das Menu
 kbd:[Aktionen/Zeige Logausgaben] wiederhergestellt werden.
 
.Fenster der Log-Ausgaben
image::App-0-LogWindow.png

=== Automatisches Update

Das Programm überprüft, ob auf dem Server eine neuere als die installierte Version bereitsteht. Ist das der Fall, öffnet sich ein Fenster, in dem die neue Version angekündigt und vorgestellt wird:

.Update-Fenster
image::App-0-Update.png[]

Soweit keine gewichtigen Gründe dagegen sprechen, sollte _immer_ die neueste Version installiert werden.

Der automatische Neustart nach der Installation einer neuen Programmversion schlägt aktuell immer fehl. Das Programm muss dann manuell noch einmal gestartet werden.

