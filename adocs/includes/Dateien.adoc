== Beteiligte Dateien und Verzeichnisse

Das Executable kann in ein Verzeichnis mit beliebigem Namen kopiert werden. Dort muss dann auch die _ClientGrundausstattung_ installiert sein. (siehe auch Kapitel <<Installation>>).

Es liegen dann mindestens die beiden Dateien +ADHelper.exe+ und +ADHelper.properties+ in diesem Verzeichnis. Wenn das Programm mindestens einmal gestartet worden ist, liegt hier auch die Log-Datei +ADHelper.log+.

Der Dateibaum innerhalb des Installationsverzeichnisses sieht grundsätzlich wie im Bild <<Dateibaum>> dargestellt aus.

[[image-dateibaum,Dateibaum]]
.Dateibaum
image::filesystem-freshinstall.png[]


=== Verzeichnis "Arbeitsdienstabrechnungen"

Alle vom Programm benutzten und erzeugten Dateien liegen unterhalb des
Verzeichnisses, in dem das Executable wohnt. Dieses Unterverzeichnis heißt
+Arbeitsdienstabrechnungen+ (ist streng genommen konfigurierbar - aber nur für
Insider ;-) ). Alle anderen Pfadangaben beziehen sich immer auf dieses 
Verzeichnis als Ausgangspunkt.

Bei Programmstart werden alle auf dem Server vorhandenen und lokal nicht
aktuellen Dateien herunter geladen. Bei Beenden des Programmes werden alle Daten
der aktuellen Periode auf den Server hochgeladen. Da beim Programmstart
überprüft wird, ob bereits eine andere Programminstanz läuft und sich die
Applikation in dem Falle selbst beendet, ist sichergestellt, dass immer mit den
aktuellen Daten gearbeitet wird.

=== Unterverzeichnis "Einstellungen"

In diesem Unterverzeichnis sind einige Dateien enthalten, die 
Programmparameter setzen. Sie sind für den normalen Benutzer ohne Belang, sie sind aber für ein korrektes Funktionieren des Programmes unerlässlich. 

.Verzeichnis Einstellungen
image::Verzeichnis-Einstellungen.png[]

So sind in der Datei +BenutzerDaten.properties+ die Eingaben gespeichert, die beim ersten Start des Programmes eingegeben wurden und den Benutzer identifizieren. In der Datei +ServerZugangsDaten.properties+ sind alle Angaben enthalten, um den Server zu finden und eine Verbindung zu ihm aufzubauen.

WARNING: Im Unterverzeichnis +ssh+ sind die Schlüssel für den sicheren Zugang zum Server enthalten. Diese Schlüssel werden jedem Benutzer persönlich ausgehändigt und sind niemals Dritten zugänglich zu machen!

=== Unterverzeichnis "misc"

Hier hinein werden bei der automatischen Programmaktualisierung einige Dateien abgelegt. Das sind beispielsweise die ReleaseNotes und das ChangeLog der jeweiligen Version.

=== Unterverzeichnis "Daten"

In diesem Unterverzeichis liegen die erzeugten und zu verwaltenden Daten.
Sie sind nach Abrechnungszeiträumen gruppiert. Ein Abrechnungszeitraum ist jeweils ein Halbjahr vom 1.1. bis zum 30.6 bzw. vom 1.7 bis zum 31.12. eines Jahres.

.Verzeichnis Daten
image::Verzeichnis-Daten.png[]

Das Verzeichnis +Obsolete+ enthält die Daten verworfener Programmläufe: Wenn der *BAUAUSSCHUSS* während eines Programmlaufes Daten geändert hat, beim Beenden des Programmes auf die Nachfrage, ob diese Daten auf den Server geladen werden sollen, aber mit kbd:[NEIN] geantwortet hat.

Neben den Unterverzeichnissen für die Abrechnungszeiträume liegt hier die
durch den Mitgliederwart zu aktualisierende Datei mit den Basisdaten der
Mitglieder, die aus dem Vereinsverwaltungsprogramm exportiert wird.

Die restlichen Dateien, die sich hier mit der Zeit ansammeln, sind zum einen Checksummen-Dateien und zum anderen Sicherungskopien der Basisdatei, die zu bestimmten Anlässen erzeugt werden.

=== Dateien eines Abrechnungszeitraumes

In jedem Unterverzeichnis eines Abrechnungszeitraumes befinden sich drei 
Quelldateien:

//[horizontal]

Basisdaten.csv::
    Diese Datei ist eine Kopie aus dem Elternverzeichnis, die dann
    angelegt wird, wenn damit begonnen wird, den Abrechnungszeitraum zu
    bearbeiten.
    Wenn bei Programmstart im Elternverzeichnis eine neuere Version dieser Datei vorliegt, als im Abrechnungsverzeichnis des aktuellen Halbjahres, wird diese Datei dorthin kopiert.

GuthabenVerlauf.csv::
    Diese Datei enthält die gesamte Geschichte des Guthabenverlaufes aller Mitglieder.

Arbeitsdienste.csv (bzw. Arbeitsdienste_old.csv)::
    Auch diese beiden Dateien entstehen durch eine Kopie der Datei
    "Arbeitsdienste.csv" der vorangegangenen Abrechnungsperiode. Sie
    sind anfangs identisch und enthalten eine fortlaufende Liste aller 
    Arbeitsdiensttermine mit allen Teilnehmern und den dabei jeweils
    geleisteten Stunden. In die Datei ohne das Suffix "_old" werden
    alle während der Bearbeitung des aktiven Abrechnungszeitraumes neu
    definierten Arbeitsdiensttermine geschrieben.

Vom Programm werden während des Ablaufes zwei MetaDateien erzeugt und hier abgelegt:

Hochgeladen.txt::
    Jedes Mal, wenn der entsprechende Bedienknopf gedrückt oder das
    Programm beendet wird, wird das komplette Verzeichnis der aktiven
    Periode auf den Server hochgeladen. Dabei wird voher diese Datei in
    den Ordner geschrieben, aus der man sehen kann, wer wann das letzte
    Hochladen vorgenommen hat.

Abgeschlossen.txt::
    Wenn eine Abrechnungsperiode abgeschlossen wird, wird in dieser
    Datei festgehalten, wer das wann getan hat.
    Auf eine einmal abgeschlossene Periode kann von da ab nur noch
    lesend zugegriffen werden.

Bei Abschluss eines Abrechnungszeitraumes werden folgende Ausgabe-Dateien erzeugt:
    
(_veraltet_: Guthaben.csv) GuthabenVerlauf.csv ::
    Hier werden die nach Hinzufügen der im Abrechnungszeitraum
    geleisteten Arbeitsdienststunden und Abzug der Pflichtstunden die
    verbleibenden bzw- erwirtschafteten Guthabenstunden hinterlegt.

Guschriften.csv::
    Dies ist eine Liste mit allen Mitgliedern, denen im betreffenden Abrechnungszeitraum eine Gutschrift in Form von Arbeitsstunden wegen früherer Fehlbuchungen gewährt worden ist.

ZuZahlendeStunden.csv::
    Dies ist eine Liste mit allen Mitgliedern, die im betreffenden
    Abrechnungszeitraum ihrer Arbeitsverplichtung nicht im vollem Umfang
    nachgekommen sind, so dass sie Ersatzzahlungen leisten müssen.

Details.txt::
    Dies ist eine Datei, in der für jedes Mitglied eine detaillierte 
    Aufstellung enthalten ist, wie seine Arbeitsdienstkleistung,
    -verpflichtung bzw. -befreiung im vorliegenden Abrechnungszeitraum
    aussieht. Sie kann bei Nachfragen zur Klärung herangezogen werden.  

==== Veraltete Dateien

In früheren Programm-Versionen wurden Dateien verwendet, die heute obsolet sind:

(#veraltet#)Guthaben.csv (bzw. Guthaben_old.csv) ::
    Beide Dateien sind eine Kopie der Datei "Guthaben.csv" aus dem
    Ordner der vorangegangenen Abrechnungsperiode. 
    Bei der Erzeugung der Kopie ohne das Suffix "_old" wird dafür Sorge
    getragen, dass das in der vorherigen Periode errechnete Endguthaben
    für die neue Periode als Anfangsguthaben markiert wird.
